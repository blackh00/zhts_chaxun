var adFtv = {
    ' 除夕': '<strong style="color:#D02F12">除夕</strong>',
    ' 春节': '<strong style="color:#D02F12">春节</strong>',
    ' 元宵节': '<strong style="color:#D02F12">元宵节</strong>',
    '0308 妇女节': '祝天下女人，妇女节快乐。',
    ' 母亲节': '祝天下所有母亲，母亲节快乐',
    ' 父亲节': '祝天下所有父亲，父亲节快乐。',
    '0501 劳动节': '<b></b>祝您<strong style="color:#D02F12">劳动节</strong>快乐！',
    ' 端午节': '<b></b>祝您端午节快乐。',
    ' 七夕': '<b></b>祝您七夕情人节快乐。',
    ' 重阳节': '祝天下所有老人，重阳节快乐。',
    ' 中秋节': '<b></b>祝您中秋节快乐。',
    '1001 国庆节': '<b></b>祝您<strong style="color:#D02F12">国庆节</strong>快乐！'
};
var lmanac = {};
var chineseYear = '';
var currentDate = '';
var lichunDate = 0;
var lunarInfo = new Array(19416, 19168, 42352, 21717, 53856, 55632, 91476, 22176, 39632, 21970, 19168, 42422, 42192, 53840, 119381, 46400, 54944, 44450, 38320, 84343, 18800, 42160, 46261, 27216, 27968, 109396, 11104, 38256, 21234, 18800, 25958, 54432, 59984, 28309, 23248, 11104, 100067, 37600, 116951, 51536, 54432, 120998, 46416, 22176, 107956, 9680, 37584, 53938, 43344, 46423, 27808, 46416, 86869, 19872, 42416, 83315, 21168, 43432, 59728, 27296, 44710, 43856, 19296, 43748, 42352, 21088, 62051, 55632, 23383, 22176, 38608, 19925, 19152, 42192, 54484, 53840, 54616, 46400, 46752, 103846, 38320, 18864, 43380, 42160, 45690, 27216, 27968, 44870, 43872, 38256, 19189, 18800, 25776, 29859, 59984, 27480, 21952, 43872, 38613, 37600, 51552, 55636, 54432, 55888, 30034, 22176, 43959, 9680, 37584, 51893, 43344, 46240, 47780, 44368, 21977, 19360, 42416, 86390, 21168, 43312, 31060, 27296, 44368, 23378, 19296, 42726, 42208, 53856, 60005, 54576, 23200, 30371, 38608, 19415, 19152, 42192, 118966, 53840, 54560, 56645, 46496, 22224, 21938, 18864, 42359, 42160, 43600, 111189, 27936, 44448, 84835);
var solarMonth = new Array(31, 28, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31);
var Gan = new Array("甲", "乙", "丙", "丁", "戊", "己", "庚", "辛", "壬", "癸");
var Zhi = new Array("子", "丑", "寅", "卯", "辰", "巳", "午", "未", "申", "酉", "戌", "亥");
var Animals = new Array("鼠", "牛", "虎", "兔", "龙", "蛇", "马", "羊", "猴", "鸡", "狗", "猪");
var solarTerm = new Array("小寒", "大寒", "立春", "雨水", "惊蛰", "春分", "清明", "谷雨", "立夏", "小满", "芒种", "夏至", "小暑", "大暑", "立秋", "处暑", "白露", "秋分", "寒露", "霜降", "立冬", "小雪", "大雪", "冬至");
var sTermInfo = new Array(0, 21208, 42467, 63836, 85337, 107014, 128867, 150921, 173149, 195551, 218072, 240693, 263343, 285989, 308563, 331033, 353350, 375494, 397447, 419210, 440795, 462224, 483532, 504758);
var nStr1 = new Array("日", "一", "二", "三", "四", "五", "六", "七", "八", "九", "十");
var nStr2 = new Array("初", "十", "廿", "卅", "□");
var shengxiaoStyle = {鼠: 'year_rat',
    牛: 'year_ox',
    虎: 'year_tiger',
    兔: 'year_rabbit',
    龙: 'year_dragon',
    蛇: 'year_snake',
    马: 'year_horse',
    羊: 'year_goat',
    猴: 'year_monkey',
    鸡: 'year_rooster',
    狗: 'year_dog',
    猪: 'year_boar'
};
var sFtv = new Array('0101*元旦 http://baike.baidu.com/view/3116.htm', '0126 国际海关日  http://baike.baidu.com/view/182693.htm', '0202 世界湿地日  http://baike.baidu.com/view/22240.htm', '0210 国际气象节 http://baike.baidu.com/view/59198.htm', '0214#情人节 http://baike.baidu.com/view/2533.htm', '0224 第三世界青年日  http://baike.baidu.com/view/1273832.htm', '0301 国际海豹日  http://baike.baidu.com/view/182669.htm', '0303 全国爱耳日 http://baike.baidu.com/view/63268.htm', '0305 学雷锋日 http://baike.baidu.com/view/165596.htm', '0308#妇女节 http://baike.baidu.com/view/328605.htm', '0312#植树节 http://baike.baidu.com/view/21813.htm', '0314@白色情人节 http://baike.baidu.com/view/9083.htm', '0315 消费者权益日 http://baike.baidu.com/view/807967.htm', '0317 中国国医节 http://baike.baidu.com/view/160937.htm', '0320 全球法语日 http://baike.baidu.com/view/1175338.htm', '0321 世界睡眠日 http://baike.baidu.com/view/21357.htm', '0322 世界水日 http://baike.baidu.com/view/21371.htm', '0323 世界气象日 http://baike.baidu.com/view/25437.htm', '0327 世界戏剧日 http://baike.baidu.com/view/1254377.htm', '0401#愚人节 http://baike.baidu.com/view/1710.htm', '0402 国际儿童图书日 http://baike.baidu.com/view/537990.htm', '0407 世界卫生日 http://baike.baidu.com/view/22478.htm', '0331@复活节 http://baike.baidu.com/view/1462.htm', '0411 世界帕金森病日 http://baike.baidu.com/view/21386.htm', '0415 非洲自由日 http://baike.baidu.com/view/395720.htm', '0418 国际古迹遗址日 http://baike.baidu.com/view/1254445.htm', '0422 地球日 http://baike.baidu.com/view/2183.htm', '0423 世界读书日 http://baike.baidu.com/view/23287.htm', '0424 亚非新闻工作者节 http://baike.baidu.com/view/28406.htm', '0426 世界知识产权日 http://baike.baidu.com/view/2186.htm', '0430 交通安全反思日 http://baike.baidu.com/view/36429.htm', '0501*劳动节 http://baike.baidu.com/view/44253.htm', '0503 世界新闻自由日 http://baike.baidu.com/view/27588.htm', '0504#青年节 http://baike.baidu.com/view/27635.htm', '0508 世界红十字日 http://baike.baidu.com/view/26823.htm', '0512 国际护士节 http://baike.baidu.com/view/25735.htm', '0515 国际家庭日 http://baike.baidu.com/view/62008.htm', '0517 世界电信日 http://baike.baidu.com/view/23216.htm', '0518 国际博物馆日 http://baike.baidu.com/view/37249.htm', '0520 全国助残日 http://baike.baidu.com/view/21415.htm', '0521 世界文化发展日 http://baike.baidu.com/view/1607380.htm', '0525 非洲解放日 http://baike.baidu.com/view/395767.htm', '0529 国际维和人员日 http://baike.baidu.com/view/395770.htm', '0530@"五卅"运动纪念日 http://baike.baidu.com/view/2340194.htm', '0531 世界无烟日 http://baike.baidu.com/view/22249.htm', '0601@六一儿童节 http://baike.baidu.com/view/16194.htm', '0605 世界环境日 http://baike.baidu.com/view/22254.htm', '0606 全国爱眼日 http://baike.baidu.com/view/21347.htm', '0611 中国人口日 http://baike.baidu.com/view/58964.htm', '0612 世界无童工日 http://baike.baidu.com/view/395779.htm', '0614 世界献血者日 http://baike.baidu.com/view/278751.htm', '0620 世界难民日 http://baike.baidu.com/view/294658.htm', '0622 中国儿童慈善活动日 http://baike.baidu.com/view/2340240.htm', '0623 国际奥林匹克日 http://baike.baidu.com/view/37371.htm', '0624 世界骨质疏松日 http://baike.baidu.com/view/950288.htm', '0625 全国土地日 http://baike.baidu.com/view/37338.htm', '0626 国际禁毒日 http://baike.baidu.com/view/106800.htm', '0630 世界青年联欢节 http://baike.baidu.com/view/890704.htm', '0701#香港回归日 http://baike.baidu.com/view/58870.htm', '0702 国际体育记者日 http://baike.baidu.com/view/160976.htm', '0707@抗日战争纪念 http://baike.baidu.com/view/80378.htm', '0711 世界人口日 http://baike.baidu.com/view/23435.htm', '0720 人类月球日 http://baike.baidu.com/view/1734698.htm', '0728 世界肝炎日 http://baike.baidu.com/view/1595022.htm', '0730 非洲妇女日 http://baike.baidu.com/view/160993.htm', '0801@八一建军节 http://baike.baidu.com/view/27204.htm', '0809 国际土著人日 http://baike.baidu.com/view/101757.htm', '0812 国际青年日 http://baike.baidu.com/view/950303.htm', '0815 日本无条件投降日 http://baike.baidu.com/view/1387589.htm', '0826 全国律师咨询日 http://baike.baidu.com/view/1629212.htm', '0908 国际扫盲日 http://baike.baidu.com/view/62062.htm', '0910#教师节 http://baike.baidu.com/view/25833.htm', '0914 世界清洁地球日 http://baike.baidu.com/view/62054.htm', '0916 国际臭氧层保护日 http://baike.baidu.com/view/22443.htm', '0918@九·一八事变纪念日 http://baike.baidu.com/view/34028.htm', '0920 国际爱牙日 http://baike.baidu.com/view/147917.htm', '0921 国际和平日 http://baike.baidu.com/view/27269.htm', '0922 世界无车日 http://baike.baidu.com/view/489563.htm', '0923 国际聋人节 http://baike.baidu.com/view/62032.htm', '0927 世界旅游日 http://baike.baidu.com/view/59496.htm', '1001*国庆节 http://baike.baidu.com/view/14446.htm', '1004 世界动物日 http://baike.baidu.com/view/59207.htm', '1008 全国高血压日 http://baike.baidu.com/view/21442.htm', '1009 世界邮政日 http://baike.baidu.com/view/26600.htm', '1010@辛亥革命纪念日 http://baike.baidu.com/view/59004.htm', '1013 世界保健日 http://baike.baidu.com/view/1917210.htm', '1014 世界标准日 http://baike.baidu.com/view/158147.htm', '1015 国际盲人节 http://baike.baidu.com/view/21456.htm', '1016 世界粮食日 http://baike.baidu.com/view/124252.htm', '1017 国际消除贫困日 http://baike.baidu.com/view/165572.htm', '1020 世界厨师日 http://baike.baidu.com/view/395884.htm', '1022 世界传统医药日 http://baike.baidu.com/view/124255.htm', '1024 联合国日 http://baike.baidu.com/view/59045.htm', '1031 世界勤俭日 http://baike.baidu.com/view/522014.htm', '1101#万圣节 http://baike.baidu.com/view/2532.htm', '1109 中国消防宣传日 http://baike.baidu.com/view/59105.htm', '1110 世界青年节 http://baike.baidu.com/view/165356.htm', '1108 中国记者日 http://baike.baidu.com/view/45983.htm', '1111#光棍节 http://baike.baidu.com/view/23105.htm', '1114 世界糖尿病日 http://baike.baidu.com/view/22284.htm', '1116 国际宽容日 http://baike.baidu.com/view/614745.htm', '1117 国际大学生节 http://baike.baidu.com/view/165576.htm', '1119 世界厕所日 http://baike.baidu.com/view/395915.htm', '1120 世界儿童日 http://baike.baidu.com/view/27462.htm', '1121 世界电视日 http://baike.baidu.com/view/163041.htm', '1201@世界艾滋病日 http://baike.baidu.com/view/28884.htm', '1203 国际残疾人日 http://baike.baidu.com/view/155500.htm', '1204 中国法制宣传日 http://baike.baidu.com/view/59086.htm', '1205 国际志愿人员日 http://baike.baidu.com/view/60704.html', '1207 国际民航日 http://baike.baidu.com/view/182725.htm', '1209@一二·九运动 http://baike.baidu.com/view/2055278.htm', '1210 世界人权日 http://baike.baidu.com/view/59173.htm', '1211 世界防治哮喘日 http://baike.baidu.com/view/22268.htm', '1212 西安事变纪念日 http://baike.baidu.com/view/961033.htm', '1213@南京大屠杀纪念日 http://baike.baidu.com/view/22274.htm', '1215 世界强化免疫日 http://baike.baidu.com/view/21469.html', '1218 国际迁徙者日 http://baike.baidu.com/view/7741807.htm', '1219 南南合作日 http://baike.baidu.com/view/2563969.htm', '1220@澳门回归纪念日 http://baike.baidu.com/view/80418.htm', '1221 国际篮球日 http://baike.baidu.com/view/22264.htm', '1224#平安夜 http://baike.baidu.com/view/28259.htm', '1225#圣诞节 http://baike.baidu.com/view/2547.htm', '1229 国际生物多样性日 http://baike.baidu.com/view/28904.htm');
var lFtv = new Array("0101*春节 http://baike.baidu.com/view/3108.htm", "0115*元宵节 http://baike.baidu.com/view/1949.htm", "0202*龙抬头 http://baike.baidu.com/view/26664.htm", "0505*端午节 http://baike.baidu.com/view/2567.htm", "0707*七夕 http://baike.baidu.com/view/8489.htm", "0715*中元节 http://baike.baidu.com/view/57902.htm", "0815*中秋节 http://baike.baidu.com/view/2568.htm", "0909*重阳节 http://baike.baidu.com/view/2572.htm", "1208*腊八节 http://baike.baidu.com/view/22439.htm", "1223*小年 http://baike.baidu.com/view/15128.htm", "0100*除夕 http://baike.baidu.com/view/2562.htm");
var wFtv = new Array('0520*母亲节 http://baike.baidu.com/view/2516.htm', '0630*父亲节 http://baike.baidu.com/view/8463.htm', '1144 感恩节 http://baike.baidu.com/view/2525.htm');
var fFtv2013 = new Array("0101 *元旦", "0102 *", "0103 *", "0105 _", "0106 _", "0209 *除夕", "0209 *", "0210 *", "0211 *", "0212 *", "0213 *", "0214 *", "0215 *", '0216 _', '0217 _', '0404 *', '0405 *', '0406 *', '0407 _', '0427 _', '0428 _', '0429 *', '0430 *', "0501 *劳动节", '0608 _', '0609 _', "0610 *", '0611 *', '0612 *', "0919 *中秋节", '0920 *', '0921 *', '0922 _', '0929 _', '1012 _', "1001 *国庆节", "1002 *", "1003 *", "1004 *", "1005 *", "1006 *", "1007 *");
var fFtv2012 = new Array("0101 *元旦", "0102 *", "0103 *", "0105 _");
function shujiu(date) {
    var month = date.getMonth() + 1;
    if (month != 12 && month != 1 && month != 2 && month != 3) {
        return ''
    }
    var year = date.getFullYear();
    var day = date.getDate();
    year = year.toString();
    var century = parseInt(year.substring(0, 2)) + 1;
    var c = '',
    d = 0.2422;
    if (century == 21) {
        c = 21.94
    } else if (century == 20) {
        c = 22.60
    } else {
        return
    }
    y = year.substring(2);
    var dongzhi = '';
    if (month == 12) {
        dongzhi = parseInt(y * d + c) - parseInt(y / 4)
    } else {
        dongzhi = parseInt((y - 1) * d + c) - parseInt((y - 1) / 4)
    }
    if (year == '1918' || year == '2021') {
        dongzhi = dongzhi - 1
    }
    year = parseInt(year);
    var feb_days = 28;
    if ((year % 4 == 0 && year % 100 != 0) || year % 400 == 0) {
        feb_days = 29
    }
    var sj = new Array('12 ' + (dongzhi) + ' 12 ' + (dongzhi + 8) + ' 一九', '12 ' + (dongzhi + 9) + ' 1 ' + (dongzhi + 17 - 31) + ' 二九', '1 ' + (dongzhi + 18 - 31) + ' 1 ' + (dongzhi + 26 - 31) + ' 三九', '1 ' + (dongzhi + 27 - 31) + ' 1 ' + (dongzhi + 35 - 31) + ' 四九', '1 ' + (dongzhi + 36 - 31) + ' 2 ' + (dongzhi + 44 - 62) + ' 五九', '2 ' + (dongzhi + 45 - 62) + ' 2 ' + (dongzhi + 53 - 62) + ' 六九', '2 ' + (dongzhi + 54 - 62) + ' 2 ' + (dongzhi + 62 - 62) + ' 七九', '2 ' + (dongzhi + 63 - 62) + ' 3 ' + (dongzhi + 71 - 62 - feb_days) + ' 八九', '3 ' + (dongzhi + 72 - 62 - feb_days) + ' 3 ' + (dongzhi + 80 - 62 - feb_days) + ' 九九');
    var sj_days = new Array('九', '八', '七', '六', '五', '四', '三', '二', '一');
    var result = '';
    for (j in sj) {
        if (sj[j].match(/^(\d{1,2})\s+(\d{1,2})\s+(\d{1,2})\s+(\d{1,2})\s+(.*?)$/)) {
            if (month == Number(RegExp.$1) && month == Number(RegExp.$3) && day >= Number(RegExp.$2) && day <= Number(RegExp.$4)) {
                result = RegExp.$5 + '第' + sj_days[parseInt(RegExp.$4) - day] + '天'
            }
            if ((RegExp.$1 != RegExp.$3) && (month == RegExp.$1 && day >= RegExp.$2)) {
                result = RegExp.$5 + '第' + sj_days[8 - (day - RegExp.$2)] + '天'
            }
            if ((RegExp.$1 != RegExp.$3) && (month == RegExp.$3 && day <= RegExp.$4)) {
                result = RegExp.$5 + '第' + sj_days[parseInt(RegExp.$4) - day] + '天'
            }
        }
    }
    return result
}
function lYearDays(c) {
    var a, b = 348;
    for (a = 32768; a > 8; a >>= 1) {
        b += (lunarInfo[c - 1900] & a) ? 1 : 0
    }
    return (b + leapDays(c))
}
function leapDays(a) {
    if (leapMonth(a)) {
        return ((lunarInfo[a - 1900] & 65536) ? 30 : 29)
    } else {
        return (0)
    }
}
function leapMonth(a) {
    return (lunarInfo[a - 1900] & 15)
}
function monthDays(b, a) {
    return ((lunarInfo[b - 1900] & (65536 >> a)) ? 30 : 29)
}
function Lunar(d) {
    var c, b = 0,
    a = 0;
    var e = (Date.UTC(d.getFullYear(), d.getMonth(), d.getDate()) - Date.UTC(1900, 0, 31)) / 86400000;
    for (c = 1900; c < 2050 && e > 0; c++) {
        a = lYearDays(c);
        e -= a
    }
    if (e < 0) {
        e += a;
        c--
    }
    this.year = c;
    b = leapMonth(c);
    this.isLeap = false;
    for (c = 1; c < 13 && e > 0; c++) {
        if (b > 0 && c == (b + 1) && this.isLeap == false) {--c;
            this.isLeap = true;
            a = leapDays(this.year)
        } else {
            a = monthDays(this.year, c)
        }
        if (this.isLeap == true && c == (b + 1)) {
            this.isLeap = false
        }
        e -= a
    }
    if (e == 0 && b > 0 && c == b + 1) {
        if (this.isLeap) {
            this.isLeap = false
        } else {
            this.isLeap = true; --c
        }
    }
    if (e < 0) {
        e += a; --c
    }
    this.month = c;
    this.day = e + 1
}
function solarDays(b, a) {
    if (a == 1) {
        return (((b % 4 == 0) && (b % 100 != 0) || (b % 400 == 0)) ? 29 : 28)
    } else {
        return (solarMonth[a])
    }
}
function cyclical(a) {
    return (Gan[a % 10] + Zhi[a % 12])
}
function calElement(a, g, j, b, f, d, e, h, c, i, k) {
    this.isToday = false;
    this.sYear = a;
    this.sMonth = g;
    this.sDay = j;
    this.week = b;
    this.lYear = f;
    this.lMonth = d;
    this.lDay = e;
    this.isLeap = h;
    this.cYear = c;
    this.cMonth = i;
    this.cDay = k;
    this.color = "";
    this.className = "";
    this.lunarFestival = "";
    this.solarFestival = "";
    this.solarTerms = ""
}
function sTerm(c, b) {
    var a = new Date((31556925974.7 * (c - 1900) + sTermInfo[b] * 60000) + Date.UTC(1900, 0, 6, 2, 5));
    return (a.getUTCDate())
}
function calendar(j, t, h) {
    var B, l, A, b, g = 1,
    e, C = 0,
    s, p, o;
    var z, a, f;
    var d = new Array(3);
    var r = 0;
    var c = 0;
    B = new Date(j, t, 1, 0, 0, 0, 0);
    this.length = solarDays(j, t);
    this.firstWeek = B.getDay();
    if (t < 2) {
        z = cyclical(j - 1900 + 36 - 1)
    } else {
        z = cyclical(j - 1900 + 36)
    }
    var v = sTerm(j, 2);
    lichunDate = v;
    var u = sTerm(j, t * 2);
    a = cyclical((j - 1900) * 12 + t + 12);
    var q = Date.UTC(j, t, 1, 0, 0, 0, 0) / 86400000 + 25567 + 10;
    for (var w = 0; w < this.length; w++) {
        if (g > C) {
            B = new Date(j, t, w + 1);
            l = new Lunar(B);
            A = l.year;
            b = l.month;
            g = l.day;
            e = l.isLeap;
            C = e ? leapDays(A) : monthDays(A, b);
            if (r == 0) {
                c = b
            }
            d[r++] = w - g + 1
        }
        if (t == 1 && (w + 1) == v) {
            z = cyclical(j - 1900 + 36)
        }
        if ((w + 1) == u) {
            a = cyclical((j - 1900) * 12 + t + 13)
        }
        f = cyclical(q + w);
        this[w] = new calElement(j, t + 1, w + 1, nStr1[(w + this.firstWeek) % 7], A, b, g++, e, z, a, f)
    }
    s = sTerm(j, t * 2) - 1;
    p = sTerm(j, t * 2 + 1) - 1;
    if (j === 2011 && t === 10) {
        this[7].solarTerms = "立冬";
        this[22].solarTerms = "小雪"
    } else {
        if (j === 2013 && t === 1) {
            this[3].solarTerms = "立春";
            this[17].solarTerms = "雨水"
        } else {
            if (j === 2012 && t === 0) {
                this[5].solarTerms = "小寒";
                this[20].solarTerms = "大寒"
            } else {
                if (j === 2012 && t === 4) {
                    this[19].solarTerms = "小满";
                    this[4].solarTerms = "立夏"
                } else if (j === 2012 && t === 11) {
                    this[6].solarTerms = "大雪";
                    this[20].solarTerms = "冬至"
                } else {
                    solarTerm[t * 2] && (this[s].solarTerms = solarTerm[t * 2]);
                    solarTerm[t * 2 + 1] && (this[p].solarTerms = solarTerm[t * 2 + 1])
                }
            }
        }
    }
    if (true) {
        for (w in sFtv) {
            if (sFtv[w].match(/^(\d{2})(\d{2})([\s\*|\s\#|\s@])(.+)\s+(.+)$/)) {
                if (Number(RegExp.$1) == (t + 1)) {
                    if (RegExp.$3 == '*') {
                        this[Number(RegExp.$2) - 1].color = '#d02f12'
                    } else if (RegExp.$3 == '#') {
                        this[Number(RegExp.$2) - 1].color = '#009900'
                    } else if (RegExp.$3 == '@') {
                        this[Number(RegExp.$2) - 1].color = '#009900'
                    } else {
                        this[Number(RegExp.$2) - 1].color = ''
                    }
                    if (RegExp.$4 == '国庆节' || RegExp.$4 == '八一建军节') {
                        if (j > 1948) {
                            this[Number(RegExp.$2) - 1].solarFestival += '<a href="' + RegExp.$5 + '" target="blank">' + RegExp.$4 + '</a> '
                        } else {
                            this[Number(RegExp.$2) - 1].color = ''
                        }
                    } else if (RegExp.$4 == '青年节' || RegExp.$4 == '六一儿童节') {
                        if (j > 1949) {
                            this[Number(RegExp.$2) - 1].solarFestival += '<a href="' + RegExp.$5 + '" target="blank">' + RegExp.$4 + '</a> '
                        } else {
                            this[Number(RegExp.$2) - 1].color = ''
                        }
                    } else if (RegExp.$4 == '香港回归日') {
                        if (j > 1996) {
                            this[Number(RegExp.$2) - 1].solarFestival += '<a href="' + RegExp.$5 + '" target="blank">' + RegExp.$4 + '</a> '
                        } else {
                            this[Number(RegExp.$2) - 1].color = ''
                        }
                    } else if (RegExp.$4 == '教师节') {
                        if (j > 1984) {
                            this[Number(RegExp.$2) - 1].solarFestival += '<a href="' + RegExp.$5 + '" target="blank">' + RegExp.$4 + '</a> '
                        } else {
                            this[Number(RegExp.$2) - 1].color = ''
                        }
                    } else if (RegExp.$4 == '植树节') {
                        if (j > 1978) {
                            this[Number(RegExp.$2) - 1].solarFestival += '<a href="' + RegExp.$5 + '" target="blank">' + RegExp.$4 + '</a> '
                        } else {
                            this[Number(RegExp.$2) - 1].color = ''
                        }
                    } else {
                        this[Number(RegExp.$2) - 1].solarFestival += '<a href="' + RegExp.$5 + '" target="blank">' + RegExp.$4 + '</a> '
                    }
                }
            }
        }
    }
    var k = parseInt($("#current-data").text());
    if (k == 2013) {
        for (w in fFtv2013) {
            if (fFtv2013[w].match(/^(\d{2})(\d{2})([\s\*])(.+)$/)) {
                if (Number(RegExp.$1) == (t + 1)) {
                    if (RegExp.$4.indexOf("*") !== -1) {
                        this[Number(RegExp.$2) - 1].solarFestival = RegExp.$4.split("*")[1] + "";
                        this[Number(RegExp.$2) - 1].className = "holidays"
                    } else {
                        if (RegExp.$4.indexOf("_") !== -1) {
                            this[Number(RegExp.$2) - 1].solarFestival = RegExp.$4.split("_")[1] + "";
                            this[Number(RegExp.$2) - 1].className = "works"
                        } else {
                            this[Number(RegExp.$2) - 1].solarFestival += RegExp.$4 + ""
                        }
                    }
                    this[Number(RegExp.$2) - 1].color = '#d02f12'
                }
            }
        }
    } else {
        if (k == 2012) {
            for (w in fFtv2012) {
                if (fFtv2012[w].match(/^(\d{2})(\d{2})([\s\*])(.+)$/)) {
                    if (Number(RegExp.$1) == (t + 1)) {
                        if (RegExp.$4.indexOf("*") !== -1) {
                            this[Number(RegExp.$2) - 1].solarFestival = RegExp.$4.split("*")[1] + "";
                            this[Number(RegExp.$2) - 1].className = "holidays"
                        } else {
                            if (RegExp.$4.indexOf("_") !== -1) {
                                this[Number(RegExp.$2) - 1].solarFestival = RegExp.$4.split("_")[1] + "";
                                this[Number(RegExp.$2) - 1].className = "works"
                            } else {
                                this[Number(RegExp.$2) - 1].solarFestival += RegExp.$4 + ""
                            }
                        }
                        this[Number(RegExp.$2) - 1].color = '#d02f12'
                    }
                }
            }
        }
    }
    for (w in wFtv) {
        if (wFtv[w].match(/^(\d{2})(\d)(\d)([\s\*|\s\#|\s@])(.+)\s+(.+)$/)) {
            if (Number(RegExp.$1) == (t + 1)) {
                s = Number(RegExp.$2);
                p = Number(RegExp.$3);
                if (s < 5) {
                    this[((this.firstWeek > p) ? 7 : 0) + 7 * (s - 1) + p - this.firstWeek].solarFestival += '<a href="' + RegExp.$6 + '" target="blank">' + RegExp.$5 + '</a> '
                } else {
                    s -= 5;
                    o = (this.firstWeek + this.length - 1) % 7;
                    this[this.length - o - 7 * s + p - (p > o ? 7 : 0) - 1].solarFestival += '<a href="' + RegExp.$6 + '" target="blank">' + RegExp.$5 + '</a> '
                }
                this[((this.firstWeek > p) ? 7 : 0) + 7 * (s - 1) + p - this.firstWeek].color = '#009900'
            }
        }
    }
    for (w in lFtv) {
        if (lFtv[w].match(/^(\d{2})(.{2})([\s\*])(.+)\s+(.+)$/)) {
            s = Number(RegExp.$1) - c;
            if (s == -11) {
                s = 1
            }
            if (s >= 0 && s < r) {
                p = d[s] + Number(RegExp.$2) - 1;
                if (p >= 0 && p < this.length && this[p].isLeap != true) {
                    this[p].lunarFestival += '<a href="' + RegExp.$5 + '" target="blank">' + RegExp.$4 + '</a> ';
                    if (RegExp.$3 == "*") {
                        this[p].color = "#d74146"
                    }
                }
            }
        }
    }
    if (this[tD - 1]) {
        this[tD - 1].isToday = true
    } else {
        this[0].isToday = true
    }
}
function easter(g) {
    var b = sTerm(g, 5);
    var d = new Date(Date.UTC(g, 2, b, 0, 0, 0, 0));
    var a = new Lunar(d);
    if (a.day < 15) {
        var f = 15 - a.day
    } else {
        var f = (a.isLeap ? leapDays(g) : monthDays(g, a.month)) - a.day + 15
    }
    var e = new Date(d.getTime() + 86400000 * f);
    var c = new Date(e.getTime() + 86400000 * (7 - e.getUTCDay()));
    this.m = c.getUTCMonth();
    this.d = c.getUTCDate()
}
function cDay(b) {
    var a;
    switch (b) {
    case 10:
        a = "初十";
        break;
    case 20:
        a = "二十";
        break;
        break;
    case 30:
        a = "三十";
        break;
        break;
    default:
        a = nStr2[Math.floor(b / 10)];
        a += nStr1[b % 10]
    }
    return (a)
}
var cld;
function drawCld(d, m, mm, yy) {

    var f, a, o, n, w, p, l, g, color;
    if (m != 0) {
        l = new calendar(d, m - 1)
    } else {
        l = new calendar(d - 1, 11)
    }
    if (m != 11) {
        g = new calendar(d, m + 1)
    } else {
        g = new calendar(d + 1, 0)
    }
    cld = new calendar(d, m);
    var b = parseInt($("#current-data-month").text());
    if (b != "1") {
        chineseYear = Animals[(d - 4) % 12]
    } else {
        if (b == "1") {
            chineseYear = Animals[(d - 5) % 12]
        }
    }
    if ((cld.length + cld.firstWeek) > 35) {
        $("#lastLine").css("display", "")
    } else {
        $("#lastLine").css("display", "none")
    }
	
    for (f = 0; f < 42; f++) {
        sObj = document.getElementById("SD" + f);
        lObj = document.getElementById("LD" + f);
        gObj = document.getElementById("GD" + f);
        sObj.className = "";
        gObj.className = "";
        a = f - cld.firstWeek;
        if (f < cld.firstWeek) {
            var j = parseInt(l.length) - parseInt(cld.firstWeek) + f;
            if (l[j] && l[j].className) {
                if (l[j].className.indexOf("holidays") != -1) {
                    lObj.parentNode.parentNode.className = "holidays"
                } else {
                    if (l[j].className.indexOf("works") != -1) {
                        lObj.parentNode.parentNode.className = "works"
                    }
                }
            }
            $('#GD' + f).addClass('tradition');
            lObj.parentNode.innerHTML = "<strong id='SD" + f + "' rel='up'>" + (j + 1) + "</strong><span id='LD" + f + "'>" + cDay(l[j].lDay) + "</span><i></i>"
        }
		
        if (f > (cld.firstWeek + cld.length - 1)) {
            if (cld.firstWeek + cld.length < 36 && f < 35) {
                var j = f - (cld.firstWeek + cld.length - 1);
                if (g[j - 1] && g[j - 1].className) {
                    if (g[j - 1].className.indexOf("holidays") != -1) {
                        lObj.parentNode.parentNode.className = "holidays"
                    } else {
                        if (g[j - 1].className.indexOf("works") != -1) {
                            lObj.parentNode.parentNode.className = "works"
                        }
                    }
                }
                $('#GD' + f).addClass('tradition');
                lObj.parentNode.innerHTML = "<strong id='SD" + f + "' rel='down'>" + j + "</strong><span id='LD" + f + "'>" + cDay(g[j - 1].lDay) + "</span><i></i>"
            }
            if (cld.firstWeek + cld.length > 35) {
                var j = f - (cld.firstWeek + cld.length - 1);
                if (g[j - 1] && g[j - 1].className) {
                    if (g[j - 1].className.indexOf("holidays") != -1) {
                        lObj.parentNode.parentNode.className = "holidays"
                    } else {
                        if (g[j - 1].className.indexOf("works") != -1) {
                            lObj.parentNode.parentNode.className = "works"
                        }
                    }
                }
                $('#GD' + f).addClass('tradition');
                lObj.parentNode.innerHTML = "<strong id='SD" + f + "' rel='down'>" + j + "</strong><span id='LD" + f + "'>" + cDay(g[j - 1].lDay) + "</span><i></i>"
            }
        }
		
        if ((cld.length + cld.firstWeek) <= 35) {
            $($("#GD" + f).children()).addClass('line5')
        } else {
            $($("#GD" + f).children()).removeClass()
        }
        if (f % 7 == 0 || f % 7 == 6) {
            $('#SD' + f).addClass('red');
			$('#LD' + f).addClass('red');
        }
		
        if (a > -1 && a < cld.length) {
            o = cld[a].lunarFestival;
            o = o.replace(/<a.*?>/g, '');
            o = o.replace('</a>', '');
            color = cld[a].color;
            o = isShowFtv(o);
            n = cld[a].solarFestival;
            n = n.replace(/<a.*?>/g, '');
            n = n.replace('</a>', '');
            w = cld[a].solarTerms;
            sObj.innerHTML = a + 1;
            if (!cld[a].isToday) {
                if (cld[a].sYear == new Date().getFullYear() && cld[a].sMonth == (new Date().getMonth() + 1) && cld[a].sDay == new Date().getDate()) {
                    sObj.parentNode.parentNode.className += "now"
                }
            }
			
            if (cld[a].isToday) {
			
                if (m == mm && cld[a].sDay == new Date().getDate()) {
                    sObj.parentNode.parentNode.className += "now"
                }
                to_day.id = f;
                to_day.jin = cld[a].sYear + "-" + cld[a].sMonth + "-" + cld[a].sDay;
                to_day.N_Date = cld[a].lYear + "-" + cld[a].lMonth + "-" + cld[a].lDay;
                to_day.click_Date = cld[a].sMonth + "_" + cld[a].sDay;
                var h;
				
                if (cld[a].solarTerms == "" && cld[a].solarFestival == "" && cld[a].lunarFestival == "") {
				
				
                    h = ""
                } else {
				
                    var solarFtv = isAdFtv(cld[a].solarFestival, adFtv);
					
                    var lunarFtv = isAdFtv(cld[a].lunarFestival, adFtv);
                    var solarFtvTmp = $.trim(solarFtv.replace(/<a.*?>/g, '').replace('</a>', ''));
                    var lunarFtvTmp = $.trim(lunarFtv.replace(/<a.*?>/g, '').replace('</a>', ''));
                    if (solarFtvTmp == lunarFtvTmp) {
                        h = '<div class="festival" id="festival">' + cld[a].solarTerms + " " + lunarFtv + "</div>"
                    } else {
                        h = '<div class="festival" id="festival">' + cld[a].solarTerms + " " + solarFtv + " " + lunarFtv + "</div>"
                    }
					
                }
                var c = "";
                if (h != "") {
                    $("#info_letter").html(h)
                } else {
                    $("#info_letter").html("")
                }
				
                $("#info_all").text(cld[a].sYear + "年 " + (cld[a].sMonth) + "月" + cld[a].sDay + "日  星期" + cld[a].week);
				
                $("#info_today").text(cld[a].sDay);
                var e = ["", "正", "二", "三", "四", "五", "六", "七", "八", "九", "十", "冬", "腊"],
                k = ["", "初一", "初二", "初三", "初四", "初五", "初六", "初七", "初八", "初九", "初十", "十一", "十二", "十三", "十四", "十五", "十六", "十七", "十八", "十九", "二十", "廿一", "廿二", "廿三", "廿四", "廿五", "廿六", "廿七", "廿八", "廿九", "三十", "三十一", "三十二"];
				
                $("#info_nong").text("农历 " + e[parseInt(cld[a].lMonth)] + "月" + k[parseInt(cld[a].lDay)]);
				
                if (parseInt(cld[a].sYear) == 2013 && parseInt(cld[a].sMonth) == 2 && parseInt(cld[a].sDay) == 3) {
                    $("#info_chang").html("壬辰年 <b>【龙年】</b> 葵丑月 庚子日");
                    $('#shengxiao').removeClass();
                    $('#shengxiao').addClass('wnl-title clearfix ' + shengxiaoStyle['龙'])
                } else {
                    $("#info_chang").html(cld[a].cYear + "年 <b>【" + chineseYear + "年】</b> " + cld[a].cMonth + "月 " + cld[a].cDay + "日");
                    $('#shengxiao').removeClass();
                    $('#shengxiao').addClass('wnl-title clearfix ' + shengxiaoStyle[chineseYear])
                }
				
                currentDate = cld[a].sYear + "-" + (parseInt(cld[a].sMonth) < 10 ? '0' + String(cld[a].sMonth) : String(cld[a].sMonth)) + "-" + (parseInt(cld[a].sDay) < 10 ? '0' + String(cld[a].sDay) : String(cld[a].sDay));
				
                showYiAndJi(currentDate);
				//return false;
                showSha(currentDate);
                var nowDate = new Date().format('yyyy-MM-dd');
                var d1_ar = nowDate.split('-');
                var d2_ar = currentDate.split('-');
                var nowMiliSecond = Date.UTC(d1_ar[0], d1_ar[1] - 1, d1_ar[2]);
                var targetMiliSecond = Date.UTC(d2_ar[0], d2_ar[1] - 1, d2_ar[2]);
                var passedTime = Math.ceil((targetMiliSecond - nowMiliSecond) / 86400000);
                var dayafterorbeforeStr = "";
                if (passedTime == 0) {
                    $('.a_1').text('今日');
                    dayafterorbeforeStr = '今天'
                }
                if (passedTime < 0) {
                    $('.a_1').text('返回今日');
                    dayafterorbeforeStr = Math.abs(passedTime) + "天前"
                } else if (passedTime > 0) {
                    $('.a_1').text('返回今日');
                    dayafterorbeforeStr = passedTime + "天后"
                }
                $('#info_diffday').html(dayafterorbeforeStr);
                var shujiuDate = new Date(targetMiliSecond);
                var res = shujiu(shujiuDate);
                if (res != "") {
                    if ($('#info_letter').html() != "") {
                        $("#festival").append(" " + res)
                    } else {
                        $('#info_letter').html('<div class="festival" id="festival">' + res + "</div>")
                    }
                }
                if ($('#info_letter').html() == '') {
                    $('#info_letter').html('<div class="festival" id="festival"></div>')
                }
                var hisUrl = '/his1.htm';
                var date = String(cld[a].sMonth) + String(cld[a].sDay < 10 ? '0' + cld[a].sDay: cld[a].sDay);
                document.getElementById("history_day").href = hisUrl + "?" + date;
                sObj.parentNode.parentNode.className += ' ' + clsHw(yy, a)
				
            } else {
                sObj.parentNode.parentNode.className += cld[a].className;
                if ((d == 2013 || (d == 2012 && yy == 11))) {
                    sObj.parentNode.parentNode.className += ' ' + clsHw(yy, a);
                    if (d == 2013 && yy == 11) {
                        gObj.className = ''
                    }
                }
            }
            var monthCn = new Array('一', '二', '三', '四', '五', '六', '七', '八', '九', '十', '十一', '十二');
            if (cld[a].lDay == 1) {
                lObj.innerHTML = "<b>" + (cld[a].isLeap ? "": "") + monthCn[cld[a].lMonth - 1] + "月</b>"
            } else {
                lObj.innerHTML = cDay(cld[a].lDay)
            }
            if (o.length > 0) {
                if (o.length > 6) {
                    o = o.substr(0, 4) + "..."
                }
                o = o.fontcolor("#d02f12")
            } else {
                o = cld[a].solarFestival;
                o = isShowFtv(o);
                if (o.length <= 0) {
                    o = cld[a].solarTerms
                }
            }
            for (var sT in solarTerm) {
                if (cld[a].solarTerms == solarTerm[sT]) {
                    o = solarTerm[sT].fontcolor("#0058b2");
                    break
                }
            }
            if (o.length > 0) {
                lObj.innerHTML = '<font color="' + color + '">' + o + '</font>'
            }
            $('#date_show').show()
        } else {
            sObj.innerHTML = "";
            lObj.innerHTML = ""
        }
    }
	
}
function clsHw(m, d) {
    var cls = '';
    for (var w in fFtv2013) {
        if (fFtv2013[w].match(/^(\d{2})(\d{2})([\s\*])(.+)$/)) {
            if (Number(RegExp.$1) == (m + 1) && Number(RegExp.$2) == (d + 1)) {
                if (RegExp.$4.indexOf("*") !== -1) {
                    cls = "holidays";
                    break
                } else {
                    if (RegExp.$4.indexOf("_") !== -1) {
                        cls = "works";
                        break
                    }
                }
            }
        }
    }
    return cls
}
function isShowFtv(ftv) {
    ftv = ftv.replace(/<a.*?>/g, '');
    ftv = ftv.replace('</a>', '');
    ftv = $.trim(ftv);
    var spFtv = '国际盲人节 国际聋人节 世界青年联欢节 日本无条件投降日 国际护士节 亚非新闻工作者节 中国国医节 国际气象节 一二·九运动 世界青年节 国际大学生节';
    var ftvArr = ftv.split(' ');
    var ft = '';
    for (var i in ftvArr) {
        ft = $.trim(ftvArr[i]);
        if ((ft.indexOf('日') != -1 && (ft.indexOf('日') + 1) == ft.length) || spFtv.indexOf(ft) != -1) {
            ftvArr[i] = ''
        }
    }
    return ftvArr.join(' ')
}
function isAdFtv(ftv, adFtv) {
    if ($.trim(ftv) == '') {
        return ''
    }
    var tmp = ftv;
    var date = new Date();
    var m = date.getMonth() + 1;
    var d = date.getDate();
    for (var i in adFtv) {
        tmp = tmp.replace(/<a.*?>/g, '');
        tmp = tmp.replace('</a>', '');
        tmp = $.trim(tmp);
        i.match(/^(\d{2})(\d{2})\s+(.*?)$/);
        if (Number(RegExp.$1) == m && Number(RegExp.$2) == d && $.trim(RegExp.$3) == tmp) {
            ftv = '<span id="info_letter" class="jieri">' + adFtv[i] + '</span>';
            break
        }
    }
    return ftv
}
function changeCld(aaa) {
    if (aaa != undefined) {
        yy = aaa
    }
    var b, a;
    b = parseInt($("#current-data").text());
    a = parseInt(parseInt($('#current-data-month').text()) - 1);
    tM = a;
    drawCld(b, a, mm, yy)
}
var Today = new Date();
var tY = Today.getFullYear();
var tM = Today.getMonth();
var tD = Today.getDate();
var mm, yy;
var width = "200";
var offsetx = 2;
var offsety = 8;
var x = 0;
var y = 0;
var snow = 0;
var sw = 0;
var cnt = 0;
var to_day = {
    id: null,
    N_Date: "",
    ip: "",
    Y_Date: "",
    click_Date: "",
    jin: null
};
function pushBtm(b, h) { ! h && showPageFun("Date");
    switch (b) {
    case "MU":
        $('.a_2').html('假日安排');
        $('.a_1').text('返回今日');
        if (parseInt($("#current-data-month").text()) > 1) {
            $("#current-data-month").html((parseInt($("#current-data-month").text()) - 1) + "月")
        } else {
            $("#current-data-month").text(12 + "月");
            if (parseInt($("#current-data").text()) - 1901 > 0) {
                $("#current-data").text((parseInt($("#current-data").text()) - 1) + "年")
            }
        }
        break;
    case "MD":
        $('.a_2').html('假日安排');
        $('.a_1').text('返回今日');
        if (parseInt($("#current-data-month").text()) < 12) {
            $("#current-data-month").text((parseInt($("#current-data-month").text()) + 1) + "月")
        } else {
            $("#current-data-month").text(1 + "月");
            if (parseInt($("#current-data").text()) - 1900 < 149) {
                $("#current-data").text((parseInt($("#current-data").text()) + 1) + "年")
            }
        }
        break;
    case "JT":
        tD = Today.getDate();
        $('.a_1').text('今日');
        $('.a_2').html('假日安排');
        $('#info_diffday').text('今天');
        $("#current-data").text(Today.getFullYear() + "年");
        $("#current-data-month").text((parseInt(Today.getMonth()) + 1) + "月");
        break;
    default:
        $("#current-data").text(tY + "年");
        $("#current-data-month").text((parseInt(tM) + 1) + "月");
        break
    }
    var yy = parseInt($('#current-data-month').text()) - 1;
    changeCld(yy)
}
function mOvr(n) {
    var b = parseInt($("#current-data-month").text()),
    j = parseInt($("#current-data").text()),
    c = parseInt($("#GD" + n).find("strong").text());
    if (b == 2) {
        if (c < lichunDate) {
            chineseYear = Animals[(j - 5) % 12]
        } else {
            chineseYear = Animals[(j - 4) % 12]
        }
    }
    var i = $("#SD" + n);
    if ($.trim(i.html()) == "" && $.trim($("#LD" + n).html()) == "") {
        return
    }
    if ($('#GD' + n).hasClass("tradition")) {
        if (i.attr("rel") && i.attr("rel") == "up") {
            var g = Math.abs(cld.firstWeek - n);
            pushBtm("MU");
            var e = cld.firstWeek + cld.length - g;
            $(".calendar td").eq(e).trigger("click")
        } else {
            var g = n - cld.firstWeek - cld.length;
            pushBtm("MD");
            var e = cld.firstWeek + g;
            $(".calendar td").eq(e).trigger("click")
        }
        return
    }
    if (to_day.id != null) {
        document.getElementById("GD" + to_day.id).className = document.getElementById("GD" + to_day.id).className.replace("today", "")
    }
    to_day.id = n;
    var o, k;
    var h = document.getElementById("SD" + n);
    h.parentNode.parentNode.className += " today";
    var l = h.innerHTML - 1;
    if (h.innerHTML != "") {
        if (cld[l].solarTerms == "" && cld[l].solarFestival == "" && cld[l].lunarFestival == "") {
            k = ""
        } else {
            k = "";
            var n = "";
            if (parseInt(cld[l].sYear) > 1948) {
                n = cld[l].solarFestival
            }
            var solarT = '';
            if (cld[l].solarTerms) {
                solarT = '<a href="http://tools.2345.com/jieqi.htm?y=' + parseInt(cld[l].sYear) + '&jq=' + escape(cld[l].solarTerms) + '" target="blank">' + cld[l].solarTerms + '</a>'
            }
            var solarFtv = isAdFtv(n, adFtv);
            var lunarFtv = isAdFtv(cld[l].lunarFestival, adFtv);
            var solarFtvTmp = $.trim(solarFtv.replace(/<a.*?>/g, '').replace('</a>', ''));
            var lunarFtvTmp = $.trim(lunarFtv.replace(/<a.*?>/g, '').replace('</a>', ''));
            if (solarFtvTmp == lunarFtvTmp) {
                k = '<div class="festival" id="festival">' + solarT + " " + lunarFtv + "</div>"
            } else {
                k = '<div class="festival" id="festival">' + solarT + " " + solarFtv + " " + lunarFtv + "</div>"
            }
        }
        var a = "";
        $("#info_all").html(cld[l].sYear + "年 " + cld[l].sMonth + "月" + cld[l].sDay + "日  星期" + cld[l].week);
		
		$.ajax({
				url:$CONFIG['siteDynamicUrl']+"/rili/diesFaustusSearch",
				dataType:'jsonp', 
				type:"get",	
				data:{"yearMonthDate":cld[l].sYear+"-"+cld[l].sMonth+"-"+cld[l].sDay},
				jsonp:'callback',
				success:function(dayInfo){
					// 用空白分割字符串
					jishi = dayInfo['ji'].split("　",9);
					
					// 保存ji中的东西
					str = "";
					for(var i in jishi){
						if(i!=0){
						str += "<span>"+jishi[i]+"</span>";
						}
					}
					
					// 往吉中添加数据
					$("#ji").html(str);
					
					// 空白分割字符串
					yishi = dayInfo['yi'].split("　",9);
					
					// 保存yi中的东西
					str = "";
					for(var i in yishi){
						if(i!=0){
						str += "<span>"+yishi[i]+"</span>";
						}
					}
					
					// 往宜事中添加数据
					$("#yi").html(str);
				}
		})
        var f = ["", "正", "二", "三", "四", "五", "六", "七", "八", "九", "十", "冬", "腊"],
        m = ["", "初一", "初二", "初三", "初四", "初五", "初六", "初七", "初八", "初九", "初十", "十一", "十二", "十三", "十四", "十五", "十六", "十七", "十八", "十九", "二十", "廿一", "廿二", "廿三", "廿四", "廿五", "廿六", "廿七", "廿八", "廿九", "三十", "三十一", "三十二"];
        tD = cld[l].sDay;
        $("#info_nong").html("农历" + (cld[l].isLeap ? "闰 ": " ") + f[parseInt(cld[l].lMonth)] + "月" + m[parseInt(cld[l].lDay)]);
        $("#info_today").html(cld[l].sDay);
        if (parseInt(cld[l].sYear) == 2013 && parseInt(cld[l].sMonth) == 2 && parseInt(cld[l].sDay) == 3) {
            $("#info_chang").html("壬辰年 <b>【龙年】</b> 葵丑月 庚子日");
            $('#shengxiao').removeClass();
            $('#shengxiao').addClass('wnl-title clearfix ' + shengxiaoStyle['龙'])
        } else {
            $("#info_chang").html(cld[l].cYear + "年 <b>【" + chineseYear + "年】</b> " + cld[l].cMonth + "月 " + cld[l].cDay + "日");
            $('#shengxiao').removeClass();
            $('#shengxiao').addClass('wnl-title clearfix ' + shengxiaoStyle[chineseYear])
        }
        $("#info_letter").html(k);
        to_day.click_Date = cld[l].sMonth + "_" + cld[l].sDay;
        currentDate = cld[l].sYear + "-" + (parseInt(cld[l].sMonth) < 10 ? '0' + String(cld[l].sMonth) : String(cld[l].sMonth)) + "-" + (parseInt(cld[l].sDay) < 10 ? '0' + String(cld[l].sDay) : String(cld[l].sDay));
        showYiAndJi(currentDate);
        showSha(currentDate);
        var hisUrl = '/his1.htm';
        var date = String(cld[l].sMonth) + String(cld[l].sDay < 10 ? '0' + cld[l].sDay: cld[l].sDay);
        $("#history_day").attr('href', hisUrl + "?" + date);
        var nowDate = new Date().format('yyyy-MM-dd');
        var d1_ar = nowDate.split('-');
        var d2_ar = currentDate.split('-');
        var nowMiliSecond = Date.UTC(d1_ar[0], d1_ar[1] - 1, d1_ar[2]);
        var targetMiliSecond = Date.UTC(d2_ar[0], d2_ar[1] - 1, d2_ar[2]);
        var passedTime = Math.ceil((targetMiliSecond - nowMiliSecond) / 86400000);
        var dayafterorbeforeStr = "";
        if (passedTime == 0) {
            $('.a_1').text('今日');
            dayafterorbeforeStr = '今天'
        }
        if (passedTime < 0) {
            $('.a_1').text('返回今日');
            dayafterorbeforeStr = Math.abs(passedTime) + "天前"
        } else if (passedTime > 0) {
            $('.a_1').text('返回今日');
            dayafterorbeforeStr = passedTime + "天后"
        }
        $('#info_diffday').html(dayafterorbeforeStr);
        var shujiuDate = new Date(targetMiliSecond);
        var res = shujiu(shujiuDate);
        if (res != "") {
            if ($('#info_letter').html() != "") {
                $("#festival").append(" " + res)
            } else {
                $('#info_letter').html('<div class="festival"  id="festival">' + res + "</div>")
            }
        }
        if ($('#info_letter').html() == '') {
            $('#info_letter').html('<div class="festival"  id="festival"></div>')
        }
    }
}
Date.prototype.format = function(format) {
    var o = {
        "M+": this.getMonth() + 1,
        "d+": this.getDate(),
        "h+": this.getHours(),
        "m+": this.getMinutes(),
        "s+": this.getSeconds(),
        "q+": Math.floor((this.getMonth() + 3) / 3),
        "S": this.getMilliseconds()
    };
    if (/(y+)/.test(format)) format = format.replace(RegExp.$1, (this.getFullYear() + "").substr(4 - RegExp.$1.length));
    for (var k in o) if (new RegExp("(" + k + ")").test(format)) format = format.replace(RegExp.$1, RegExp.$1.length == 1 ? o[k] : ("00" + o[k]).substr(("" + o[k]).length));
    return format
};
function reEvent(e) {
    var e = e || window.event;
    if (e.preventDefault) {
        e.preventDefault()
    } else {
        e.returnValue = false
    }
    return e
}
function showMenuAni(el, top) {
    el.css("display", "block").animate({
        opacity: 1,
        top: top || 25
    },
    200)
}
function closeMenuAni(el, top) {
    el.animate({
        opacity: 0,
        top: top || 10
    },
    200,
    function() {
        el.css("display", "none")
    })
}
function showPageFun(p, bacFun) {
    if (p) {
        $("#date_count_btn").removeClass("a_4");
        $("#record_saved").removeClass("a_4");
        $("#date_tips").show();
        if (bacFun) {
            bacFun()
        }
        return 1
    }
}
function initial() {
    $('body').bind('click',
    function(e) {
        if (e.target.id != 'select-year-option' && e.target.id != 'current-data') {
            $('#select-year-option').css({
                'display': 'none'
            })
        }
        if (e.target.id != 'current-data-month' && e.target.id != 'select-month-option') {
            $('#select-month-option').css({
                'display': 'none'
            })
        }
        if ($(e.target).attr('class') != 'a_2' && $(e.target).attr('class') != 'holidays_ul') {
            $('.holidays_ul').css({
                'display': 'none'
            })
        }
        if (e.target.id != 'from_year' && e.target.id != 'year_from_box') {
            $('#year_from_box').css({
                'display': 'none'
            })
        }
        if (e.target.id != 'from_month' && e.target.id != 'month_from_box') {
            $('#month_from_box').css({
                'display': 'none'
            })
        }
        if (e.target.id != 'from_day' && e.target.id != 'day_from_box') {
            $('#day_from_box').css({
                'display': 'none'
            })
        }
        if (e.target.id != 'end_year' && e.target.id != 'year_end_box') {
            $('#year_end_box').css({
                'display': 'none'
            })
        }
        if (e.target.id != 'end_month' && e.target.id != 'month_end_box') {
            $('#month_end_box').css({
                'display': 'none'
            })
        }
        if (e.target.id != 'end_day' && e.target.id != 'day_end_box') {
            $('#day_end_box').css({
                'display': 'none'
            })
        }
        if (e.target.id != 'yj_keyword' && e.target.id != 'keyword_yj_box') {
            $('#keyword_yj_box').css({
                'display': 'none'
            })
        }
        if (e.target.id != 'js_year' && e.target.id != 'js_year_box') {
            $('#js_year_box').css({
                'display': 'none'
            })
        }
        if (e.target.id != 'js_month' && e.target.id != 'js_month_box') {
            $('#js_month_box').css({
                'display': 'none'
            })
        }
        if (e.target.id != 'js_day' && e.target.id != 'js_day_box') {
            $('#js_day_box').css({
                'display': 'none'
            })
        }
    });
    $(".a_2").click(function(e) {
        var e = reEvent(e);
        if ($(".holidays_ul").css("display") === "none") {
            showMenuAni($(".holidays_ul"), 25)
        } else {
            closeMenuAni($('.holidays_ul'))
        }
    });
    $(".holidays_ul li").click(function(e) {
        var e = reEvent(e);
        if (showPageFun("Date") == 1) {
            closeMenuAni($(".holidays_ul"));
            $('.a_2').html($(this).text());
            $("#current-data-month").text($(this).attr("rel") + "月");
            $("#current-data").text(parseInt(new Date().getFullYear()) + "年");
            var yy = parseInt($(this).attr('rev'));
            tD = $(this).attr('red');
            changeCld(yy)
        }
    });
    $("#current-data").click(function(e) {
        var e = reEvent(e),
        t = $(this);
        if ($("#select-year-option").css("display") === "block") {
            t.parent().removeClass("hv");
            closeMenuAni(t.next())
        } else {
            var mon_list = $("#select-month-option");
            closeMenuAni(mon_list);
            mon_list.parent().removeClass("month_hv");
            showMenuAni(t.next());
            t.parent().addClass("hv");
            t.next().scrollTop(1980);
            var tempYear = parseInt($('#current-data').text());
            var top = parseInt(tempYear - 1901) * 20;
            $('#select-year').scrollTop(top)
        }
    });
    $("#current-data-month").click(function(e) {
        var e = reEvent(e);
        var t = $(this);
        if ($("#select-month-option").css("display") === "block") {
            t.parent().removeClass("month_hv");
            closeMenuAni(t.next())
        } else {
            var year = $("#select-year-option");
            closeMenuAni(year);
            year.parent().removeClass("hv");
            t.parent().addClass("month_hv");
            showMenuAni(t.next())
        }
    });
    $(".select-year li").click(function(e) {
        $('.a_1').text('返回今日');
        $('.a_2').html('假日安排');
        var e = reEvent(e),
        t = $(this);
        var temp = t.html();
        if (t.closest(".year-data").find(".current-data").length != 0) {
            temp = temp.replace('年', '');
            t.text(temp);
            t.closest(".year-data").find(".current-data").text(t.text() + "年");
            t.html(temp + "年")
        } else {
            temp = temp.replace('&nbsp;&nbsp;', '');
            temp = temp.replace('月', '');
            t.text(temp);
            if (parseInt(temp) < 10) {
                t.html("&nbsp;&nbsp;" + temp + "月")
            } else {
                t.html(temp + "月")
            }
            t.closest(".month-data").find("#current-data-month").html(t.html())
        }
        currentDate = parseInt($('#current-data').text()) + "-" + (parseInt($('#current-data-month').text()) < 10 ? '0' + String(parseInt($('#current-data-month').text())) : String(parseInt($('#current-data-month')))) + "-01";
        var nowDate = new Date().format('yyyy-MM-dd');
        var d1_ar = nowDate.split('-');
        var d2_ar = currentDate.split('-');
        var nowMiliSecond = Date.UTC(d1_ar[0], d1_ar[1] - 1, d1_ar[2]);
        var targetMiliSecond = Date.UTC(d2_ar[0], d2_ar[1] - 1, d2_ar[2]);
        var passedTime = Math.ceil((targetMiliSecond - nowMiliSecond) / 86400000);
        var dayafterorbeforeStr = "";
        if (passedTime == 0) {
            dayafterorbeforeStr = '今天'
        }
        if (passedTime < 0) {
            dayafterorbeforeStr = Math.abs(passedTime) + "天前"
        } else if (passedTime > 0) {
            dayafterorbeforeStr = passedTime + "天后"
        }
		
        $('#info_diffday').html(dayafterorbeforeStr);
        var yy = parseInt($('#current-data-month').text()) - 1;
        changeCld(yy);
        $(".year-data").removeClass("hv");
        $("#month-data").removeClass("month_hv");
		
        closeMenuAni(t.closest(".select-wrap"))
		
    });
    var ttt = new Date();
    mm = ttt.getMonth();
    $("#current-data").text(yearInfo[tY - 1900] + "年");
    $("#current-data-month").text((parseInt(tM) + 1) + "月");
    var yy = parseInt($('#current-data-month').text()) - 1;
    drawCld(tY, tM, mm, yy);
    pushBtm("")
}
function loadJs(_url, _callback) {
    var callback = arguments[1] ||
    function() {};
    var _script = document.createElement("SCRIPT");
    _script.setAttribute("type", "text/javascript");
    _script.setAttribute("src", _url);
    document.getElementsByTagName("head")[0].appendChild(_script);
    if (document.all) {
        _script.onreadystatechange = function() {
            if (/onload|loaded|complete/.test(_script.readyState)) {
                callback && callback()
            }
        }
    } else {
        _script.onload = function() {
            callback()
        }
    }
}
function showYiAndJi(date) {
    var year = date.substr(0, 4);
    if (year < 1998 || year > 2018) {
        return false
    }
    //var jsFile = "/api/app/yjcs/" + year + ".js";
    //loadJs(jsFile)
}
function lmanac_2345() {
    var today = currentDate;
    var _date = today.split('-');
    var year = _date[0];
    var month = _date[1];
    var day = _date[2];
    var index_ = "d" + month + day;
    var yjcs_ = lmanac[year][index_];
    var yiHtml = new Array(),
    jiHtml = new Array();
    if (yjcs_.y.length > 0) {
        if (yjcs_.y.length >= 10) {
            yi_length = 10
        } else {
            yi_length = yjcs_.y.length
        }
        for (var i = 0; i < yi_length; i++) {
            yiHtml.push('<a href="/huanglijieshi.htm" target="_blank">' + yjcs_.y[i] + '</a>\n')
        }
    }
    $("#yi").html('<div class="icon"></div>\n' + yiHtml.join(''));
    if (yjcs_.j.length > 0) {
        if (yjcs_.j.length >= 10) {
            ji_length = 10
        } else {
            ji_length = yjcs_.j.length
        }
        for (var j = 0; j < ji_length; j++) {
            jiHtml.push('<a href="/huanglijieshi.htm" target="_blank">' + yjcs_.j[j] + '</a>\n')
        }
    }
    $("#ji").html('<div class="icon"></div>\n' + jiHtml.join(''));
    $('#hMore').attr('href', '/laohuangli.htm?date=' + today + '#1')
}
function addFavorite() {
    var url = window.location;
    var name = document.title;
    try {
        window.external.addFavorite(url, name)
    } catch(e) {
        try {
            window.sidebar.addPanel(name, url, "")
        } catch(e) {
            alert("您的浏览器暂不支持该功能，请使用Ctrl+D加入到收藏夹")
        }
    }
}
function showSha(currentDate) {
    var dd = currentDate.split('-');
    var year = dd[0];
    var month = dd[1];
    var day = dd[2];
    if (year < 2010 || year > 2020) {
        return false
    }
    var fileName = '/api/app/god/' + year + '/' + month + '/' + year + month + day + '.js';
    var shaHtml = new Array();
    shaHtml.push('<div class="icon"></div>\n');
}